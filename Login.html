<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>fireBank</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>

  <body>



    
    <script type="module">
     import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-app.js";
     import { getDatabase, set, ref } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-database.js";
     import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.3.0/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCO6eht5DllhUaodOFfU_yrhIjMPzrI860",
        authDomain: "firebank-d29c6.firebaseapp.com",
        databaseURL: "https://firebank-d29c6-default-rtdb.firebaseio.com",
        projectId: "firebank-d29c6",
        storageBucket: "firebank-d29c6.firebasestorage.app",
        messagingSenderId: "956045682523",
        appId: "1:956045682523:web:55639153b31e6635df9c7e"
      };
    
      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getDatabase();
      const auth = getAuth();

      const email = document.getElementById("EmailInp");
      const pass = document.getElementById("PasswordInp");
      const name = document.getElementById("NameInp");
      const AddBtn = document.getElementById("AddEmployeeBtn");
      const AdminPass = document.getElementById("AdminPasswordInp");

      // First checks if the admin's password is correct before registering new user
      const RegisterEmployeeUser = () => {
        // Authenticates admins credentials
        signInWithEmailAndPassword(auth, "admin@bank.com", AdminPass.value)
        .then((admincred) => {
          // Creates new employee user
          createUserWithEmailAndPassword(auth, email.value, pass.value)
          .then((creds) => {
            // Writes or replace Email and FullName employee details to EmployeeList based on uid
            // Note: ref points to the location for writing, while set does the writing/overwriting
            set(ref(db, "EmployeeList/" + creds.user.uid), {
              Email: email.value,
              FullName: name.value
            });
            signOut(auth);
            AdminPass.value = "";
            alert("Employee User was Created!");
          })
          .catch((error) => {
            alert("Error: " + error.message);
          })
        })

        .catch((error) => {
          alert("Error: " + error)
        })
      }

      AddBtn.addEventListener("click", RegisterEmployeeUser);      
    </script>

    <!-- Bootstrap Js Script -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>